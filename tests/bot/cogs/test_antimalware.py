import asyncio
import unittest

from bot.cogs import antimalware
from tests.helpers import MockBot, MockMessage


class AntiMalwareCogTests(unittest.TestCase):
    """Test the AntiMalware cog."""

    def setUp(self):
        """Sets up fresh objects for each test."""
        self.bot = MockBot()
        self.cog = antimalware.AntiMalware(self.bot)
        self.message = MockMessage()

    def test_message_without_attachment(self):
        """Messages without attachments should result in no action."""
        coroutine = self.cog.on_message(self.message)
        self.assertIsNone(asyncio.run(coroutine))
